/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

plugins {
    id "com.moowork.node" version "1.3.1"
}

node {
    version = '12.14.1'
    npmVersion = '6.13.6'
    distBaseUrl = 'https://nodejs.org/dist'
    download = true
    workDir = file("${project.buildDir}/nodejs")
    npmWorkDir = file("${project.buildDir}/npm")
    nodeModulesDir = file("${project.projectDir}")
}

// A bug with the package lock system causes npm not to download
// local dependencies.
npmInstall.args = ['--no-package-lock']

task buildDistribution(type: Copy) {
    from(project.projectDir) {
        exclude "build", "build.gradle", ".gradle", "settings.gradle"
    }
    into "${project.buildDir}/distribution/${project.name}"
}

buildDistribution.dependsOn npmInstall
build.dependsOn buildDistribution
